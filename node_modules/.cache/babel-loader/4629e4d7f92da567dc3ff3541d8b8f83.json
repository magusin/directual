{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hugo\\\\code\\\\akatek\\\\directual\\\\src\\\\pages\\\\Page1.js\";\nimport React, { useEffect, useState } from 'react';\nimport Directual from 'directual-api';\nimport { useAuth } from '../auth';\nimport { Loader } from '../components/loader/loader';\nimport { Card, CardBody, CardHeader, CardText, CardTitle, Container } from 'reactstrap';\nimport { Link } from 'react-router-dom'; // Example of getting data from Directual\n// Connect to Directual api\n\nconst api = new Directual({\n  apiHost: '/'\n});\nexport default function Page1() {\n  // API-endpoint details\n  const dataStructure = 'product'; // todo: write here sysname of your data structure\n\n  const endpoint = 'getProducts'; // todo: write here Method name of your API-endpoint\n  // connect authentication context\n\n  const auth = useAuth(); // Hooks for handling state\n\n  const [payload, setPayload] = useState([]); // API response\n\n  const [pageInfo, setPageInfo] = useState({}); // API response metadata, e.g. number of objects\n\n  const [loading, setLoading] = useState(true); // initial loader\n\n  const [badRequest, setBadRequest] = useState(); // API error message\n\n  const [pageLoading, setPageLoading] = useState(false); // paging loader\n\n  const [pageNum, setPageNum] = useState(0); // Page number, by default = 0\n\n  const [pageSize] = useState(2); // Page size, bu default = 10\n\n  const [showForm, setShowForm] = useState(true); // Show/hide the form\n\n  const [formPayload, setFormPayload] = useState(); // Data to send. Here we can add userID: auth.user by default\n  // Paging\n\n  useEffect(() => {\n    setPageLoading(true);\n    getData(); // eslint-disable-next-line\n  }, [pageNum]);\n\n  const nextPage = () => {\n    setPageLoading(true);\n    setPageNum(pageNum + 1);\n  };\n\n  const prevPage = () => {\n    setPageLoading(true);\n    setPageNum(pageNum - 1);\n  };\n\n  const actualPage = () => {\n    setPageLoading(true);\n    setPageNum(pageNum === i);\n  };\n\n  console.log(pageInfo); // GET-request\n\n  function getData() {\n    api // Data structure\n    .structure(dataStructure) // GET request + query params (sessionID, page, pageSize by default)\n    .getData(endpoint, {\n      sessionID: auth.sessionID,\n      page: pageNum,\n      pageSize: pageSize\n    }) // other possible query params:\n    // {{HttpRequest}} — any param for Filtering\n    // sort=FIELD_SYSNAME_1,desc,FIELD_SYSNAME_2,asc — sorting with multiple params\n    .then(response => {\n      setPayload(response.payload);\n      setPageInfo(response.pageInfo);\n      setLoading(false);\n      setPageLoading(false);\n    }).catch(e => {\n      // handling errors\n      setLoading(false);\n      setPageLoading(false);\n      console.log(e.response);\n      setBadRequest(e.response.status + ', ' + e.response.data.msg);\n    });\n  }\n\n  function postData() {\n    setLoading(true);\n    setShowForm(false);\n    api // Data structure\n    .structure(dataStructure) // POST request + payload + query params:\n    .setData(endpoint, formPayload, {\n      sessionID: auth.sessionID\n    }).then(response => {\n      setResponse(response.result);\n      setStatus(response.status);\n      setLoading(false);\n    }).catch(e => {\n      // handling errors\n      setLoading(false);\n      console.log(e.response);\n      setBadRequest({\n        httpCode: e.response.status,\n        msg: e.response.data.msg\n      });\n    });\n  }\n\n  let items = [];\n\n  for (var i = 1; i <= pageInfo.totalPage; i++) {\n    items.push( /*#__PURE__*/React.createElement(\"button\", {\n      onClick: actualPage,\n      key: i,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 7\n      }\n    }, i));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }, \"Produits et services\"), loading && /*#__PURE__*/React.createElement(Loader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 19\n    }\n  }), payload && !loading && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"request-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }, \"Data structure:\", ' ', /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 15\n    }\n  }, dataStructure ? dataStructure : /*#__PURE__*/React.createElement(\"span\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 19\n    }\n  }, \"not provided\"))), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }, \"API-endpoint:\", ' ', /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 15\n    }\n  }, endpoint ? endpoint : /*#__PURE__*/React.createElement(\"span\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 19\n    }\n  }, \"not provided\"))), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }\n  }, \"Payload: \", /*#__PURE__*/React.createElement(\"code\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 24\n    }\n  }, JSON.stringify(payload))), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }\n  }, \"Payload info: \", /*#__PURE__*/React.createElement(\"code\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 29\n    }\n  }, JSON.stringify(pageInfo))), badRequest && /*#__PURE__*/React.createElement(\"code\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 15\n    }\n  }, \"Error: \", /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 24\n    }\n  }, badRequest))), /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 11\n    }\n  }, payload.map(data => /*#__PURE__*/React.createElement(Link, {\n    to: {\n      pathname: `/product/${data.id}`,\n      state: {\n        data: data.id\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    className: \"border-1 border-primary text-center mb-2 \",\n    key: data.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(CardHeader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(CardTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 23\n    }\n  }, data.title))), /*#__PURE__*/React.createElement(CardBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    alt: \"none\",\n    src: data.file,\n    className: \"image\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(CardText, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 23\n    }\n  }, data.description)), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 21\n    }\n  }, data.company)), showForm && /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: postData,\n    encType: \"multipart/form-data\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    placeholder: \"File\",\n    onChange: e => {\n      setFormPayload({ ...formPayload,\n        'file': e.target.value\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 19\n    }\n  })))))), pageLoading && /*#__PURE__*/React.createElement(Loader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 27\n    }\n  }), !pageLoading &&\n  /*#__PURE__*/\n  // <div>\n  //   <button disabled={(pageNum <= 0) && \"disabled\"} onClick={prevPage}>prev</button>\n  //   <button disabled={(badRequest || (pageNum >= pageInfo.totalPage - 1)) && \"disabled\"} onClick={nextPage}>next</button>\n  // </div>\n  React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"nav\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    id: \"pagination\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: pageNum <= 0 ? 'disabled' : '',\n    onClick: prevPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 19\n    }\n  }, \"Pr\\xE9c\\xE9dent\"), items, /*#__PURE__*/React.createElement(\"button\", {\n    className: pageNum >= pageInfo.totalPage - 1 ? 'disabled' : '',\n    onClick: nextPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 19\n    }\n  }, \"Suivant\"))))));\n}","map":{"version":3,"sources":["C:/Users/Hugo/code/akatek/directual/src/pages/Page1.js"],"names":["React","useEffect","useState","Directual","useAuth","Loader","Card","CardBody","CardHeader","CardText","CardTitle","Container","Link","api","apiHost","Page1","dataStructure","endpoint","auth","payload","setPayload","pageInfo","setPageInfo","loading","setLoading","badRequest","setBadRequest","pageLoading","setPageLoading","pageNum","setPageNum","pageSize","showForm","setShowForm","formPayload","setFormPayload","getData","nextPage","prevPage","actualPage","i","console","log","structure","sessionID","page","then","response","catch","e","status","data","msg","postData","setData","setResponse","result","setStatus","httpCode","items","totalPage","push","JSON","stringify","map","pathname","id","state","title","file","description","company","target","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport Directual from 'directual-api'\r\nimport { useAuth } from '../auth'\r\nimport { Loader } from '../components/loader/loader'\r\nimport {\r\n  Card,\r\n  CardBody,\r\n  CardHeader,\r\n  CardText,\r\n  CardTitle,\r\n  Container\r\n} from 'reactstrap'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Example of getting data from Directual\r\n\r\n// Connect to Directual api\r\nconst api = new Directual({ apiHost: '/' })\r\n\r\nexport default function Page1() {\r\n  // API-endpoint details\r\n  const dataStructure = 'product' // todo: write here sysname of your data structure\r\n  const endpoint = 'getProducts' // todo: write here Method name of your API-endpoint\r\n\r\n  // connect authentication context\r\n  const auth = useAuth()\r\n\r\n  // Hooks for handling state\r\n  const [payload, setPayload] = useState([]) // API response\r\n  const [pageInfo, setPageInfo] = useState({}) // API response metadata, e.g. number of objects\r\n  const [loading, setLoading] = useState(true) // initial loader\r\n  const [badRequest, setBadRequest] = useState() // API error message\r\n  const [pageLoading, setPageLoading] = useState(false) // paging loader\r\n  const [pageNum, setPageNum] = useState(0) // Page number, by default = 0\r\n  const [pageSize] = useState(2) // Page size, bu default = 10\r\n  const [showForm, setShowForm] = useState(true); // Show/hide the form\r\n  const [formPayload, setFormPayload] = useState(); // Data to send. Here we can add userID: auth.user by default\r\n\r\n  // Paging\r\n  useEffect(() => {\r\n    setPageLoading(true)\r\n    getData()\r\n    // eslint-disable-next-line\r\n  }, [pageNum])\r\n\r\n  const nextPage = () => {\r\n    setPageLoading(true)\r\n    setPageNum(pageNum + 1)\r\n  }\r\n  const prevPage = () => {\r\n    setPageLoading(true)\r\n    setPageNum(pageNum - 1)\r\n  }\r\n  const actualPage = () => {\r\n    setPageLoading(true)\r\n    setPageNum(pageNum === i)\r\n  }\r\n  console.log(pageInfo)\r\n  // GET-request\r\n  function getData() {\r\n    api\r\n      // Data structure\r\n      .structure(dataStructure)\r\n      // GET request + query params (sessionID, page, pageSize by default)\r\n      .getData(endpoint, {\r\n        sessionID: auth.sessionID,\r\n        page: pageNum,\r\n        pageSize: pageSize\r\n      })\r\n      // other possible query params:\r\n      // {{HttpRequest}} — any param for Filtering\r\n      // sort=FIELD_SYSNAME_1,desc,FIELD_SYSNAME_2,asc — sorting with multiple params\r\n      .then((response) => {\r\n        setPayload(response.payload)\r\n        setPageInfo(response.pageInfo)\r\n        setLoading(false)\r\n        setPageLoading(false)\r\n      })\r\n      .catch((e) => {\r\n        // handling errors\r\n        setLoading(false)\r\n        setPageLoading(false)\r\n        console.log(e.response)\r\n        setBadRequest(e.response.status + ', ' + e.response.data.msg)\r\n      })\r\n  }\r\n  function postData() {\r\n    setLoading(true)\r\n    setShowForm(false)\r\n    api\r\n      // Data structure\r\n      .structure(dataStructure)\r\n      // POST request + payload + query params:\r\n      .setData(endpoint, formPayload,\r\n        { sessionID: auth.sessionID })\r\n      .then((response) => {\r\n        setResponse(response.result)\r\n        setStatus(response.status)\r\n        setLoading(false)\r\n      })\r\n      .catch((e) => {\r\n        // handling errors\r\n        setLoading(false)\r\n        console.log(e.response)\r\n        setBadRequest({\r\n          httpCode: e.response.status,\r\n          msg: e.response.data.msg\r\n        })\r\n      })\r\n  }\r\n  let items = []\r\n\r\n  for (var i = 1; i <= pageInfo.totalPage; i++) {\r\n    items.push(\r\n      <button onClick={actualPage} key={i}>\r\n        {i}\r\n      </button>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"content\">\r\n      <h1>Produits et services</h1>\r\n\r\n      {loading && <Loader />}\r\n      {payload && !loading && (\r\n        <div>\r\n          {/* API response */}\r\n          <div className=\"request-info\">\r\n            <span>\r\n              Data structure:{' '}\r\n              <b>\r\n                {dataStructure ? (\r\n                  dataStructure\r\n                ) : (\r\n                  <span className=\"error\">not provided</span>\r\n                )}\r\n              </b>\r\n            </span>\r\n            <span>\r\n              API-endpoint:{' '}\r\n              <b>\r\n                {endpoint ? (\r\n                  endpoint\r\n                ) : (\r\n                  <span className=\"error\">not provided</span>\r\n                )}\r\n              </b>\r\n            </span>\r\n            <span>\r\n              Payload: <code>{JSON.stringify(payload)}</code>\r\n            </span>\r\n            <span>\r\n              Payload info: <code>{JSON.stringify(pageInfo)}</code>\r\n            </span>\r\n            {badRequest && (\r\n              <code className=\"error\">\r\n                Error: <b>{badRequest}</b>\r\n              </code>\r\n            )}\r\n          </div>\r\n          <Container>\r\n            {payload.map((data) => (\r\n              <Link\r\n                to={{\r\n                  pathname: `/product/${data.id}`,\r\n                  state: { data: data.id }\r\n                }}\r\n              >\r\n                <Card\r\n                  className=\"border-1 border-primary text-center mb-2 \"\r\n                  key={data.id}\r\n                >\r\n                  <CardHeader>\r\n                    <CardTitle>\r\n                      <h3>{data.title}</h3>\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardBody>\r\n                    <img alt='none' src={data.file} className='image'></img>\r\n                    <CardText>\r\n                      <p>{data.description}</p>\r\n                    </CardText>\r\n                    <p>{data.company}</p>\r\n                  </CardBody>\r\n                  {showForm &&\r\n        <form onSubmit={postData} encType=\"multipart/form-data\">\r\n                  <input type=\"file\" placeholder='File' onChange={(e) => {\r\n            setFormPayload({ ...formPayload, 'file': e.target.value })\r\n          }} />\r\n           </form>\r\n      }\r\n                </Card>\r\n              </Link>\r\n            ))}\r\n          </Container>\r\n          {/* Paging */}\r\n          {pageLoading && <Loader />}\r\n          {!pageLoading && (\r\n            // <div>\r\n            //   <button disabled={(pageNum <= 0) && \"disabled\"} onClick={prevPage}>prev</button>\r\n            //   <button disabled={(badRequest || (pageNum >= pageInfo.totalPage - 1)) && \"disabled\"} onClick={nextPage}>next</button>\r\n            // </div>\r\n            <div>\r\n              <nav>\r\n                <ul id=\"pagination\">\r\n                  <button\r\n                    className={pageNum <= 0 ? 'disabled' : ''}\r\n                    onClick={prevPage}\r\n                  >\r\n                    Précédent\r\n                  </button>\r\n                  {items }\r\n                  <button\r\n                    className={pageNum >= pageInfo.totalPage - 1 ? 'disabled' : ''}\r\n                    onClick={nextPage}\r\n                  >\r\n                    Suivant\r\n                  </button>\r\n                </ul>\r\n              </nav>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}