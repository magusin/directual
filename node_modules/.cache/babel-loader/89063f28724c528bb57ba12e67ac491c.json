{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || Object.assign || function (t) {\n  for (var s, i = 1, n = arguments.length; i < n; i++) {\n    s = arguments[i];\n\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n  }\n\n  return t;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar axios_1 = require(\"axios\");\n\nvar axiosInstance = axios_1.default.create({\n  headers: {\n    post: {\n      'Content-Type': 'application/json'\n    }\n  }\n});\n\nvar Token =\n/** @class */\nfunction () {\n  function Token(token, username, role) {\n    this.sessionID = token;\n    this.username = username;\n    this.role = role;\n  }\n\n  return Token;\n}();\n\nexports.Token = Token;\n\nvar Auth =\n/** @class */\nfunction () {\n  function Auth(config) {\n    this.config = config;\n  }\n\n  Auth.prototype.isAuthenticated = function () {\n    return Promise.resolve(false);\n  };\n\n  Auth.prototype.isAuthorize = function (sid, cb) {\n    this.check(sid).then(function (res) {\n      cb(res.result, res.token);\n    });\n  };\n\n  Auth.prototype.login = function (login, pass) {\n    return axiosInstance.request({\n      method: 'POST',\n      url: \"/good/api/v5/auth\",\n      baseURL: \"\" + this.config.apiHost,\n      params: __assign({}, this.config),\n      data: {\n        appID: this.config.appID,\n        provider: 'rest',\n        username: login,\n        password: pass\n      }\n    }).then(function (result) {\n      if (result.status === 200 && result.data) {\n        var token = new Token(result.data.result.token, result.data.result.username, result.data.result.role);\n        return Promise.resolve(token);\n      }\n\n      return Promise.reject(new Error('No reason but to reject'));\n    });\n  };\n\n  Auth.prototype.logout = function (sessionID) {\n    return axiosInstance.request({\n      method: 'GET',\n      url: \"/good/api/v4/auth/logout\",\n      baseURL: \"\" + this.config.apiHost,\n      params: __assign({}, this.config, {\n        sessionID: sessionID\n      }),\n      data: {\n        appID: this.config.appID\n      }\n    }).then(function (result) {\n      return Promise.resolve();\n    });\n  };\n\n  Auth.prototype.check = function (sessionID) {\n    return axiosInstance.request({\n      method: 'GET',\n      url: \"/good/api/v4/auth/check\",\n      baseURL: \"\" + this.config.apiHost,\n      params: __assign({}, this.config, {\n        sessionID: sessionID\n      })\n    }).then(function (result) {\n      return Promise.resolve(result.data.result);\n    });\n  };\n\n  return Auth;\n}();\n\nexports.Auth = Auth;","map":{"version":3,"mappings":"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","names":["axiosInstance","axios_1","create","headers","post","token","username","role","sessionID","exports","config","Auth","Promise","resolve","sid","cb","check","then","res","result","login","pass","request","method","url","baseURL","apiHost","params","data","appID","provider","password","status","Token","reject","Error"],"sourceRoot":"","sources":["../src/auth.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}